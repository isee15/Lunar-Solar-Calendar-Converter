<html>
<head><title>����</title></head>
<body>
<center>
    <table width=780 border=0 cellpadding=3 cellspacing=0>
        <tr>
            <td style='line-height:150%;font-size:16px;text-indent: 20'>
                <p><a href="readme.htm">����</a></p>

                <p align=center><b>������ �������</b></p>

                <p><b>������</b><br><br>
                    ����ʼ��ʼΪ��1��1��1�գ���Ӧ����622��7��16�ա�<br>
                    ���ڻ�����1������Ϊ30�꣬����ƽ��354��ÿ��,����355�죬1����֮����11������,��������Ϊ30�ꡣ<br>
                    ������ķֲ���1�����еĵ�2��5��7��10��13��16��18��21��24��26��29�ꡣ<br>
                    ��ÿ��12���£�������30�죬˫����29�죬����������12��Ҳ��30�졣<br>
                    ���ɼ�1������12*29.5*30+11=10631��
                </p>

                <p><b>Ϊ�˱������㣬������ʱ�����˼�������:</b><br><br>

                    ��INT(a)�����С�ڵ���a����С����<br>
                    ���ܻ��� n:�ӹ�Ԫ622��7��16���������ռ�����մ�0��ʼ��622��7��26�Ļ���Ϊ10��<br>
                    ��d0��J2000.0���������������ô n = d0 + 503105<br>
                    �����ڻ���A:ĳ����������׵�ƫ������<br>
                    �����ڻ���B:ĳ����������׵�ƫ������<br>
                    �����ڻ���d:ĳ����������׵�ƫ������<br><br>

                    ��������k��ĳһ�ܵ���������ڻ���ʼ��ƫ�Ƶ�����<br>
                    ��������y��ĳһ�����������ڸ��������ܵ����ױ��Ƶ�����<br>
                    ��������m��ĳһ�µ���������ڸ�������������ױ��Ƶ�����<br>
                    ��������d��ĳһ������ڸ��������µ����ױ��Ƶ��������൱�����ڻ��ա� <br>
                </p>


                <p><b>��J2000.0�����������d0�������</b></p>

                <p>n = d0+503105</p>

                <p>k = INT( n/10631 )</p>

                <p>A = n -k*10631</p>

                <p>y = INT( (A+0.5)/354.366 )</p>

                <p>B = A - INT( y*354.366+0.5 )</p>

                <p>m = INT( (B+0.11)/29.51 )</p>

                <p>d = B - INT(29.5*m+0.5)</p>

                <p>�������� y+1+k*30���¼��� m+1���ռ��� d+1</p>

                <p><b>��֪������n��������y��������m��������d�����ܻ���k</b></p>

                <p>k = 10631*n + INT(y*354.366+0.5) + INT(29.5*m+0.5) + d</p>


                <hr>
                <p><b>�����㷨���Ƶ�</b></p>

                <p><b>һ����֪�ܻ���n����������k�����ڻ���A</b></p>

                <p>������k = INT( (n+0.01)/10631 ) ����(ʽ1)</p>

                <p>���ڻ��գ�A = n -k*10631 ����(ʽ2)</p>

                <p>
                    ��ʽ�ж��˸�0.01��Ϊ�˷�ֹ��������ʱ���?�����֮Ϊ�ضϲ�������Ϊ���������ʱ����ʹ�ù������Ҳδ�صõ���������0.22/0.22�Ľ�������0.99999999999999994,ȡ�������0,����ȷֵӦ��1��һЩ����С����0.5��0.25��0.125��2������η���ϵ�����Ա������ȷ��ʾ�����ᷢ��ضϣ�����������Բ���0.01����k
                    = INT( n/10631 )��</p>

                <p><b>������֪���ڻ���A����������y�����ڻ���B</b><br><br>

                    <b>(1)����������</b><br><br>
                    &nbsp; ƽ��ÿ��354.366�գ����� c = D/354.366�����ǵ�����Ϊ����,�� y =
                    INT(c)��Ȼ�������㷨����ĩ�����׿��������������y���1�������б����£�
                </p>

<pre>

����y	����A	c
0����	0	0
1����	354	0.99896717
2����	709	2.00075628
3����	1063	2.99972345
4����	1417	3.998690619
5����	1772	5.00047973
6����	2126	5.9994469
7����	2481	7.00123601
8����	2835	8.00020318
9����	3189	8.999170349
10����	3544	10.00095946
11����	3898	10.99992663
12����	4252	11.9988938
13����	4607	13.00068291
14����	4961	13.99965008
15����	5315	14.99861725
16����	5670	16.00040636
17����	6024	16.99937353
18����	6379	18.00116264
19����	6733	19.00012981
20����	7087	19.99909698
21����	7442	21.00088609
22����	7796	21.99985326
23����	8150	22.99882043
24����	8505	24.00060954
25����	8859	24.99957671
26����	9214	26.00136582
27����	9568	27.00033299
28����	9922	27.99930016
29����	10277	29.00108927
</pre>

                <p>
                    ���б��з��֣�������£�c�������Ӧ��0��ʼ˳�����ӵ�29�������Ľ��ȴ���ǡ��ӱ��п�����ֻҪ��n��ֵ��һ��㣬�Ϳ���ʹc��ֵ����ʽ�ɸ�дΪ:</p>

                <p> c = (A+0.5)/354.366������</p>

                <p> y = INT(c) = INT((A+0.5)/354.366) ����(ʽ3)</p>

                <p>
                    ��ʽ��ԭ����ֵ����һ��0.5�����ǲ�������̫�࣬�����������ˣ���ĩȴ������󡣰��ϱ��еĻ���ȫ����1�����¼���ɵ���ĩ�����������Ƿ���ȷ(��ȷֵӦΪ-1��28)��������Excel�������,ȷ��ȡֵ0.5�ǿɿ��ġ�</p>

                <p><b>(2)�����������ڻ���B</b></p>

                <p>ÿ��������354��,�������ڻ��մ�ԼΪ B = A -
                    y*354��Ȼ�������㷨û�п���������Ի��յ�Ӱ�졣�ڻ����У�30����11��ƽ��ÿ��354.366�ա�С��0.366����"����ٶ�"����ÿ������0.366�ա�����y�������c
                    =
                    0.366*y�գ����Ƕ�fȡ��õ������������˼���Ľ�������й涨�����겻�ᷢ������ͬ����ݡ�����ʹ��Excel���㲢�ȶԣ����ѷ��֣�ֻҪ����0.5�վͿɽ�����⡣�±���e�ǰ�����涨�ĵ�������л��۵����������������������ʽ��дΪ
                    c = 0.366*y + 0.5�����±��п�������c������������e</p>

<pre>

y����	e����	c(���)
0	0	0.5
1(��)	0	0.866
2	1	1.232
3	1	1.598
4(��)	1	1.964
5	2	2.33
6(��)	2	2.696
7	3	3.062
8	3	3.428
9(��)	3	3.794
10	4	4.16
11	4	4.526
12(��)	4	4.892
13	5	5.258
14	5	5.624
15(��)	5	5.99
16	6	6.356
17(��)	6	6.722
18	7	7.088
19	7	7.454
20(��)	7	7.82
21	8	8.186
22	8	8.552
23(��)	8	8.918
24	9	9.284
25(��)	9	9.65
26	10	10.016
27	10	10.382
28(��)	10	10.748
29	11	11.114
30	11	11.48
</pre>

                <p>������ e = INT(c) = INT(0.366*y+0.5)��ʽ��yָƫ�����׵�����(�൱��������)</p>

                <p>��ˣ�B = A - y*354 - e = A - INT(y*354.366+0.5) ����(ʽ4)</p>

                <p><b>(3)�ж�y���Ƿ�Ϊ����</b></p>

                <p>��������������������ֵ���� d-INT(d) > 0.634 ��������(���ϱ���d�ı仯���ɵõ�)��</p>

                <p><b>����֪���ڵĻ���B����������m�����ڻ���d</b></p>

                <p>(1)��������m</p>

                <p>���һ��ֻ��354��,�㷨�ܼ�: c = B/29.5��Ȼ����� m =
                    INT(c)������ʵ�ϣ�һ�������354��Ҳ������355�졣��Ϊ355��ʱ��ʹ����ʽ���һ�콫�����Ϊ��13����(������Ϊ12)�����±���ʾ(����)��</p>
<pre>

����m	����B	c=B/29.5
0����	0	0
1����	30	1.016949153
2����	59	2
3����	89	3.016949153
4����	118	4
5����	148	5.016949153
6����	177	6
7����	207	7.016949153
8����	236	8
9����	266	9.016949153
10����	295	10
11����	325	11.01694915
11��ĩ	354	12(�˴�����)
</pre>
                <p>���������</p>

                <p>
                    ��B��һ�����Բ���������ֵΪС��e����B<325(m<11)ʱ��e>0����B>325ʱe<0��ͨ�����ֲ�������m<11ʱcʱ������һ�㣬��֮c��С��һ�㣬����������һ��c������ּ�С1���������c������ֱ��ֲ��䣬c��ֵȫ����ȷ�ˡ����ǻ�Ӧע�⣬����mȡ0��12���κ�ֵʱ��e��ֵ���ܳ�0.5���������µ���ĩ��c
                    = B/29.5 = 29/29.5=0.983��������ȷ�ģ����B������0.5����ô c = 29.5/29.5 =1(��ɵ�2��,��Ȼȷ��)��������e =
                    a*(325-B)��a������ѡȡ��һ������,ͬʱ��e<0.5������a*(325-0)<0.5����325*a<0.5</p>

                <p>c = (B+e)/29.5<br>
                    = (B(1-a) + a*325)/29.5<br>
                    ��(B+a*325) / (29.5+29.5*a)<br>
                    &nbsp; �����a��a*29.5����ô<br>
                    c ��(B+11*a) / (29.5+a)��ʽ��0<11*a<0.5<br><br>

                    &nbsp; ��ȡa=0.01ʱ��11*a=0.11<0.5<br>
                    m = INT(c) = INT((B+0.11)/29.51) ����(ʽ5)<br>
                </p>

                <p>(2)�����ڻ���d</p>

                <p>��Ϊm��ռ���� INT(29.5*m+0.5)������</p>

                <p>d = B - INT(29.5*m+0.5) ����(ʽ6)</p>

                <p><b>�ġ��ۺϣ���֪�ܻ���n����������k��������y��������m��������d(��:���ڻ���)</b></p>

                <p>�� (ʽ1)��(ʽ6)�������</p>

                <p>k = INT( n/10631 )</p>

                <p>A = n -k*10631</p>

                <p>y = INT( (A+0.5)/354.366 )</p>

                <p>B = A - INT( y*354.366+0.5 )</p>

                <p>m = INT( (B+0.11)/29.51 )</p>

                <p>d = B - INT(29.5*m+0.5)</p>

                <p>���</p>

                <p>����� y+1+k*30</p>

                <p>�¼��� m+1</p>

                <p>�ռ��� d+1</p>

                <p><b>�塢�ۺϣ���֪������n��������y��������m��������d�����ܻ���k</b></p>

                <p>k = 10631*n + INT(y*354.366+0.5) + INT(29.5*m+0.5) + d</p>


            </td>
        </tr>
    </table>
</center>
</body>
</html>
